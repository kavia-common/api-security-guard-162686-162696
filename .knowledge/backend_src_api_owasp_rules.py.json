{"is_source_file": true, "format": "Python", "description": "This source file defines OWASP security rules and heuristics related to API security. It includes rule definitions, functions to check for specific security issues based on headers, request methods, paths, and payload sizes, and mappings to remediation guidance. The code provides lightweight, explainable heuristics for detecting potential API security issues following OWASP Top 10 categories.", "external_files": ["dataclasses", "typing"], "external_methods": ["dataclass", "Dict", "List", "Optional", "Tuple"], "published": ["Rule", "OWASP_RULES", "check_sensitive_header_leak", "check_sensitive_path_method", "check_large_payload", "rule_to_remediation"], "classes": [{"name": "Rule", "description": "Represents a simple OWASP heuristic rule."}], "methods": [{"name": "Optional[Rule] check_sensitive_header_leak(response_headers: Dict[str, str])", "description": "Check if response headers include potentially sensitive values.", "scope": "", "scopeKind": ""}, {"name": "Optional[Rule] check_sensitive_path_method(method: str, path: str)", "description": "Check for sensitive path with destructive method.", "scope": "", "scopeKind": ""}, {"name": "Optional[Rule] check_large_payload(payload_size: Optional[int])", "description": "Heuristic for mass-assignment or unusually large payloads.", "scope": "", "scopeKind": ""}, {"name": "Tuple[str,List[str]] rule_to_remediation(rule_id: str)", "description": "Map a rule id to a brief remediation title and steps.", "scope": "", "scopeKind": ""}], "calls": ["OWASP_RULES.get", "dict.items", "any", "str.lower", "str.upper"], "search-terms": ["OWASP", "heuristic rules", "security checks", "API security", "lightweight heuristics", "response headers", "path inspection", "payload size", "security misconfiguration", "rate limiting", "mass assignment"], "state": 2, "file_id": 8, "knowledge_revision": 20, "git_revision": "", "ctags": [{"_type": "tag", "name": "LARGE_PAYLOAD_THRESHOLD_BYTES", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^LARGE_PAYLOAD_THRESHOLD_BYTES = 1_000_000  # 1 MB$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "OWASP_RULES", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^OWASP_RULES: Dict[str, Rule] = {$/", "language": "Python", "typeref": "typename:Dict[str, Rule]", "kind": "variable"}, {"_type": "tag", "name": "Rule", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^class Rule:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SENSITIVE_HEADER_KEYS", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^SENSITIVE_HEADER_KEYS = {\"authorization\", \"x-api-key\", \"x-auth-token\", \"set-cookie\"}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SENSITIVE_PATH_KEYWORDS", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^SENSITIVE_PATH_KEYWORDS = {\"admin\", \"internal\", \"private\", \"secret\"}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SUSPECT_METHODS", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^SUSPECT_METHODS = {\"PUT\", \"DELETE\", \"PATCH\"}$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "check_large_payload", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^def check_large_payload(payload_size: Optional[int]) -> Optional[Rule]:$/", "language": "Python", "typeref": "typename:Optional[Rule]", "kind": "function", "signature": "(payload_size: Optional[int])"}, {"_type": "tag", "name": "check_sensitive_header_leak", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^def check_sensitive_header_leak(response_headers: Dict[str, str]) -> Optional[Rule]:$/", "language": "Python", "typeref": "typename:Optional[Rule]", "kind": "function", "signature": "(response_headers: Dict[str, str])"}, {"_type": "tag", "name": "check_sensitive_path_method", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^def check_sensitive_path_method(method: str, path: str) -> Optional[Rule]:$/", "language": "Python", "typeref": "typename:Optional[Rule]", "kind": "function", "signature": "(method: str, path: str)"}, {"_type": "tag", "name": "rule_to_remediation", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/owasp_rules.py", "pattern": "/^def rule_to_remediation(rule_id: str) -> Tuple[str, List[str]]:$/", "language": "Python", "typeref": "typename:Tuple[str,List[str]]", "kind": "function", "signature": "(rule_id: str)"}], "hash": "0823b225a9969732fc012427e7a8e5c0", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/owasp_rules.py", "fields": [{"name": "LARGE_PAYLOAD_THRESHOLD_BYTES = 1_000_000  # 1 MB", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, Rule] OWASP_RULES", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SENSITIVE_HEADER_KEYS = {\"authorization\", \"x-api-key\", \"x-auth-token\", \"set-cookie\"}", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SENSITIVE_PATH_KEYWORDS = {\"admin\", \"internal\", \"private\", \"secret\"}", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SUSPECT_METHODS = {\"PUT\", \"DELETE\", \"PATCH\"}", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"20": ""}]}