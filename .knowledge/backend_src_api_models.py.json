{"is_source_file": true, "format": "Python", "description": "This file defines internal domain models for the Guardial API Security backend, including data classes, enums, and core entities such as API keys, events, findings, and rate limits. It serves as the internal data structure layer for the application logic and storage.", "external_files": ["schemas.py"], "external_methods": ["secrets.token_urlsafe"], "published": ["FindingSeverity", "EventType", "APIKey", "APIDescriptor", "EventRecord", "Finding", "RateLimitPolicy", "Report"], "classes": [{"name": "FindingSeverity", "description": "Severity levels for security findings/alerts."}, {"name": "EventType", "description": "Represents known types of events that can be ingested."}, {"name": "APIKey", "description": "Internal representation of an API key record."}, {"name": "APIDescriptor", "description": "Represents an API endpoint description derived from OpenAPI or manual registration."}, {"name": "EventRecord", "description": "Represents an ingested API call event."}, {"name": "Finding", "description": "Represents a security finding/alert."}, {"name": "RateLimitPolicy", "description": "Represents a rate limiting policy with methods to check allowance."}, {"name": "Report", "description": "Represents a generated report placeholder."}], "methods": [{"name": "str generate_token(prefix: str = \"gk_\", length: int = 32)", "description": "Generates a random API token, returning a string with a prefix.", "scope": "APIKey", "scopeKind": "class"}, {"name": "bool is_allowed(self, key: str, now: Optional[datetime] = None)", "description": "Checks if a request identified by 'key' is allowed under the rate limit policy.", "scope": "RateLimitPolicy", "scopeKind": "class"}], "calls": ["secrets.token_urlsafe"], "search-terms": ["domain models", "APIKey", "RateLimitPolicy", "FindingSeverity", "EventRecord", "APIDescriptor"], "state": 2, "file_id": 5, "knowledge_revision": 11, "git_revision": "", "ctags": [{"_type": "tag", "name": "APIDescriptor", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class APIDescriptor:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "APIKey", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class APIKey:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AUTH", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    AUTH = \"auth\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "CRITICAL", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    CRITICAL = \"critical\"$/", "language": "Python", "kind": "variable", "scope": "FindingSeverity", "scopeKind": "class"}, {"_type": "tag", "name": "CUSTOM", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    CUSTOM = \"custom\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "ERROR", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    ERROR = \"error\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "EventRecord", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class EventRecord:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "EventType", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class EventType(str, Enum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Finding", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class Finding:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "FindingSeverity", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class FindingSeverity(str, Enum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "HIGH", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    HIGH = \"high\"$/", "language": "Python", "kind": "variable", "scope": "FindingSeverity", "scopeKind": "class"}, {"_type": "tag", "name": "INFO", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    INFO = \"info\"$/", "language": "Python", "kind": "variable", "scope": "FindingSeverity", "scopeKind": "class"}, {"_type": "tag", "name": "LOW", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    LOW = \"low\"$/", "language": "Python", "kind": "variable", "scope": "FindingSeverity", "scopeKind": "class"}, {"_type": "tag", "name": "MEDIUM", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    MEDIUM = \"medium\"$/", "language": "Python", "kind": "variable", "scope": "FindingSeverity", "scopeKind": "class"}, {"_type": "tag", "name": "RATE_LIMIT", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    RATE_LIMIT = \"rate_limit\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "REQUEST", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    REQUEST = \"request\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "RESPONSE", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    RESPONSE = \"response\"$/", "language": "Python", "kind": "variable", "scope": "EventType", "scopeKind": "class"}, {"_type": "tag", "name": "RateLimitPolicy", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class RateLimitPolicy:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Report", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^class Report:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "acked_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    acked_at: Optional[datetime] = None$/", "language": "Python", "typeref": "typename:Optional[datetime]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "acknowledged", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    acknowledged: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "api_key_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    api_key_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "attributes", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    attributes: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "counters", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    counters: Dict[str, List[datetime]] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, List[datetime]]", "kind": "variable", "scope": "RateLimitPolicy", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    created_at: datetime = field(default_factory=datetime.utcnow)$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    created_at: datetime = field(default_factory=datetime.utcnow)$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    created_at: datetime = field(default_factory=datetime.utcnow)$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "RateLimitPolicy", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    description: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    description: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Report", "scopeKind": "class"}, {"_type": "tag", "name": "enabled", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    enabled: bool = True$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "enabled", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    enabled: bool = True$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "RateLimitPolicy", "scopeKind": "class"}, {"_type": "tag", "name": "endpoint_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    endpoint_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "event_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    event_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "generate_token", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    def generate_token(prefix: str = \"gk_\", length: int = 32) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(prefix: str = \"gk_\", length: int = 32)", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "ip", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    ip: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "is_allowed", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    def is_allowed(self, key: str, now: Optional[datetime] = None) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, key: str, now: Optional[datetime] = None)", "scope": "RateLimitPolicy", "scopeKind": "class"}, {"_type": "tag", "name": "last_used_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    last_used_at: Optional[datetime] = None$/", "language": "Python", "typeref": "typename:Optional[datetime]", "kind": "variable", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "latency_ms", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    latency_ms: Optional[float] = None$/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "metadata", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    metadata: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "metadata", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    metadata: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "operation_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    operation_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "parameters", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    parameters: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "Report", "scopeKind": "class"}, {"_type": "tag", "name": "payload_size", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    payload_size: Optional[int] = None$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "request_headers", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    request_headers: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "request_schema", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    request_schema: Optional[Dict] = None$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "response_headers", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    response_headers: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "response_schema", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    response_schema: Optional[Dict] = None$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "rule_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    rule_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "scopes", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    scopes: Set[str] = field(default_factory=set)$/", "language": "Python", "typeref": "typename:Set[str]", "kind": "variable", "scope": "APIKey", "scopeKind": "class"}, {"_type": "tag", "name": "service", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    service: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Finding", "scopeKind": "class"}, {"_type": "tag", "name": "stats", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    stats: Dict[str, float] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, float]", "kind": "variable", "scope": "Report", "scopeKind": "class"}, {"_type": "tag", "name": "status_code", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    status_code: Optional[int] = None$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "EventRecord", "scopeKind": "class"}, {"_type": "tag", "name": "tags", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    tags: List[str] = field(default_factory=list)$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    updated_at: datetime = field(default_factory=datetime.utcnow)$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "APIDescriptor", "scopeKind": "class"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/models.py", "pattern": "/^    updated_at: datetime = field(default_factory=datetime.utcnow)$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "RateLimitPolicy", "scopeKind": "class"}], "hash": "f3e6c8e08e40e781b0634755b310a769", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/models.py", "fields": [{"name": "AUTH = \"auth\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "CRITICAL = \"critical\"", "scope": "FindingSeverity", "scopeKind": "class", "description": "unavailable"}, {"name": "CUSTOM = \"custom\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "ERROR = \"error\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "HIGH = \"high\"", "scope": "FindingSeverity", "scopeKind": "class", "description": "unavailable"}, {"name": "INFO = \"info\"", "scope": "FindingSeverity", "scopeKind": "class", "description": "unavailable"}, {"name": "LOW = \"low\"", "scope": "FindingSeverity", "scopeKind": "class", "description": "unavailable"}, {"name": "MEDIUM = \"medium\"", "scope": "FindingSeverity", "scopeKind": "class", "description": "unavailable"}, {"name": "RATE_LIMIT = \"rate_limit\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "REQUEST = \"request\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "RESPONSE = \"response\"", "scope": "EventType", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[datetime] acked_at", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "bool acknowledged", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] api_key_id", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] attributes", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, List[datetime]] counters", "scope": "RateLimitPolicy", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime created_at", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "bool enabled", "scope": "APIKey", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] endpoint_id", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] event_id", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] ip", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[datetime] last_used_at", "scope": "APIKey", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[float] latency_ms", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] metadata", "scope": "APIKey", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] operation_id", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] parameters", "scope": "Report", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[int] payload_size", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] request_headers", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[Dict] request_schema", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] response_headers", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[Dict] response_schema", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] rule_id", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "Set[str] scopes", "scope": "APIKey", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] service", "scope": "Finding", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, float] stats", "scope": "Report", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[int] status_code", "scope": "EventRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "List[str] tags", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime updated_at", "scope": "APIDescriptor", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"11": ""}]}