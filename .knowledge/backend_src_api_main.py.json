{"is_source_file": true, "format": "Python", "description": "The file is a FastAPI application entry point defining an API backend for security and monitoring, including endpoints for health checks, event ingestion, API descriptor management, findings, rate limiting, API keys, and reporting.", "external_files": ["./models", "./schemas", "./storage", "./services", "./rate_limit"], "external_methods": ["fastapi.FastAPI", "fastapi.HTTPException", "fastapi.Query", "fastapi.middleware.cors.CORSMiddleware", "build_adaptive_rate_limiter", "DetectionService", "APIDescriptorRepository", "APIKeyRepository", "EventRepository", "FindingRepository", "RateLimitRepository", "ReportingService", "AdaptiveRateLimitMiddleware"], "published": ["app"], "classes": [{"name": "FastAPI", "description": "Main FastAPI application instance used to define HTTP routes."}], "methods": [{"name": "health_check()", "description": "Health check endpoint to verify service is running.", "scope": "", "scopeKind": ""}, {"name": "ingest_event(payload: EventIngestRequest)", "description": "Endpoint to ingest new security events.", "scope": "", "scopeKind": ""}, {"name": "list_events( service: Optional[str] = Query(default=None, description=\"Filter by service.\"), path: Optional[str] = Query(default=None, description=\"Filter by path.\"), )", "description": "Retrieve list of ingested events, optionally filtered.", "scope": "", "scopeKind": ""}, {"name": "upsert_api_endpoint(payload: APIDescriptorCreateRequest)", "description": "Register or update an API endpoint descriptor.", "scope": "", "scopeKind": ""}, {"name": "list_api_endpoints(service: Optional[str] = Query(default=None, description=\"Filter by service name.\"))", "description": "List registered API endpoint descriptors.", "scope": "", "scopeKind": ""}, {"name": "create_finding(payload: FindingCreateRequest)", "description": "Create a new security finding/alert.", "scope": "", "scopeKind": ""}, {"name": "list_findings( severity: Optional[FindingSeverity] = Query(default=None, description=\"Filter by severity.\"), acknowledged: Optional[bool] = Query(default=None, description=\"Filter by acknowledgment.\"), )", "description": "Retrieve list of findings, optionally filtered.", "scope": "", "scopeKind": ""}, {"name": "ack_finding(finding_id: str, payload: FindingAcknowledgeRequest)", "description": "Acknowledge or unacknowledge a specific finding.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] rate_limit_status()", "description": "Get current runtime status of rate limits.", "scope": "", "scopeKind": ""}, {"name": "create_rate_limit(payload: RateLimitPolicyCreateRequest)", "description": "Create a new rate limiting policy.", "scope": "", "scopeKind": ""}, {"name": "list_rate_limits()", "description": "List all configured rate limiting policies.", "scope": "", "scopeKind": ""}, {"name": "update_rate_limit(policy_id: str, payload: RateLimitPolicyCreateRequest)", "description": "Update an existing rate limiting policy.", "scope": "", "scopeKind": ""}, {"name": "create_api_key(payload: APIKeyCreateRequest)", "description": "Create a new API key (token returned once).", "scope": "", "scopeKind": ""}, {"name": "list_api_keys()", "description": "List existing API keys (tokens withheld).", "scope": "", "scopeKind": ""}, {"name": "update_api_key(key_id: str, payload: APIKeyUpdateRequest)", "description": "Update properties of an API key.", "scope": "", "scopeKind": ""}, {"name": "delete_api_key(key_id: str)", "description": "Delete an API key.", "scope": "", "scopeKind": ""}, {"name": "generate_report(payload: ReportQuery)", "description": "Generate a statistical report over current data.", "scope": "", "scopeKind": ""}], "calls": ["DetectionService.on_event_ingested", "_events.add", "_api_desc.upsert", "_api_desc.list", "_findings.create", "_findings.list", "_findings.set_ack", "_rate_limits.create", "_rate_limits.list", "_rate_limits.update", "_api_keys.create", "_api_keys.list", "_api_keys.update", "_api_keys.delete", "_reports.generate"], "search-terms": ["FastAPI application", "security findings endpoints", "rate limiter middleware", "API descriptor management", "in-memory repositories", "health check", "events ingestion", "API key management"], "state": 2, "file_id": 3, "knowledge_revision": 34, "git_revision": "fe6953bcad9e66ea0aab4e91b899677956bde96c", "revision_history": [{"9": "a9b0bcf3d925ba4bf274c933437343a4a28753f5"}, {"16": "2b00f3fe22739cea6491cdb5e7caacda4d18183f"}, {"17": "2b00f3fe22739cea6491cdb5e7caacda4d18183f"}, {"29": "503dc9131a87ccadb497670b73542005fae6c333"}, {"33": "fe6953bcad9e66ea0aab4e91b899677956bde96c"}, {"34": "fe6953bcad9e66ea0aab4e91b899677956bde96c"}], "ctags": [{"_type": "tag", "name": "_api_desc", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_api_desc = APIDescriptorRepository()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_api_keys", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_api_keys = APIKeyRepository()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_detection", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_detection = DetectionService(api_catalog=_api_desc, events=_events, findings=_findings)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_events", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_events = EventRepository()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_findings", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_findings = FindingRepository()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_limiter", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_limiter = build_adaptive_rate_limiter(rate_limits=_rate_limits, events=_events, api_catalog=_ap/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_rate_limits", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_rate_limits = RateLimitRepository()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_reports", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^_reports = ReportingService(events=_events, findings=_findings)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ack_finding", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def ack_finding(finding_id: str, payload: FindingAcknowledgeRequest):$/", "language": "Python", "kind": "function", "signature": "(finding_id: str, payload: FindingAcknowledgeRequest)"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_api_key", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def create_api_key(payload: APIKeyCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: APIKeyCreateRequest)"}, {"_type": "tag", "name": "create_finding", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def create_finding(payload: FindingCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: FindingCreateRequest)"}, {"_type": "tag", "name": "create_rate_limit", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def create_rate_limit(payload: RateLimitPolicyCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: RateLimitPolicyCreateRequest)"}, {"_type": "tag", "name": "delete_api_key", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def delete_api_key(key_id: str):$/", "language": "Python", "kind": "function", "signature": "(key_id: str)"}, {"_type": "tag", "name": "generate_report", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def generate_report(payload: ReportQuery):$/", "language": "Python", "kind": "function", "signature": "(payload: ReportQuery)"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "ingest_event", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def ingest_event(payload: EventIngestRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: EventIngestRequest)"}, {"_type": "tag", "name": "list_api_endpoints", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def list_api_endpoints(service: Optional[str] = Query(default=None, description=\"Filter by servi/", "language": "Python", "kind": "function", "signature": "(service: Optional[str] = Query(default=None, description=\"Filter by service name.\"))"}, {"_type": "tag", "name": "list_api_keys", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def list_api_keys():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_events", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def list_events($/", "language": "Python", "kind": "function", "signature": "( service: Optional[str] = Query(default=None, description=\"Filter by service.\"), path: Optional[str] = Query(default=None, description=\"Filter by path.\"), )"}, {"_type": "tag", "name": "list_findings", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def list_findings($/", "language": "Python", "kind": "function", "signature": "( severity: Optional[FindingSeverity] = Query(default=None, description=\"Filter by severity.\"), acknowledged: Optional[bool] = Query(default=None, description=\"Filter by acknowledgment.\"), )"}, {"_type": "tag", "name": "list_rate_limits", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def list_rate_limits():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "rate_limit_status", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def rate_limit_status() -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "update_api_key", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def update_api_key(key_id: str, payload: APIKeyUpdateRequest):$/", "language": "Python", "kind": "function", "signature": "(key_id: str, payload: APIKeyUpdateRequest)"}, {"_type": "tag", "name": "update_rate_limit", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def update_rate_limit(policy_id: str, payload: RateLimitPolicyCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(policy_id: str, payload: RateLimitPolicyCreateRequest)"}, {"_type": "tag", "name": "upsert_api_endpoint", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/main.py", "pattern": "/^def upsert_api_endpoint(payload: APIDescriptorCreateRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: APIDescriptorCreateRequest)"}], "hash": "ef7bbabc9910b13d52338b8036f81b5a", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/main.py", "fields": [{"name": "_api_desc = APIDescriptorRepository()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_api_keys = APIKeyRepository()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_detection = DetectionService(api_catalog=_api_desc, events=_events, findings=_findings)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_events = EventRepository()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_findings = FindingRepository()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_limiter = build_adaptive_rate_limiter(rate_limits=_rate_limits, events=_events, api_catalog=_ap/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_rate_limits = RateLimitRepository()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_reports = ReportingService(events=_events, findings=_findings)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}]}