{"is_source_file": true, "format": "Python", "description": "This Python source file implements a heuristic detector for shadow APIs. It defines data structures and classes to analyze observed traffic (service, method, path) against known API descriptors, identify potential shadow endpoints, and generate findings with severity levels based on certain keywords in the paths.", "external_files": ["./models", "./owasp_rules"], "external_methods": ["FindingSeverity.MEDIUM", "FindingSeverity.HIGH", "OWASP_RULES.get"], "published": ["ShadowDetectionResult", "ShadowAPIDetector"], "classes": [{"name": "ShadowDetectionResult", "description": "Data class representing the result of a shadow API detection, including whether it's a shadow, suggested title, description, severity, and rule ID."}, {"name": "ShadowAPIDetector", "description": "A heuristic detector class that checks if observed API traffic corresponds to a shadow endpoint by comparing against known keys and analyzing path contents for sensitive keywords."}], "methods": [{"name": "ShadowDetectionResult detect(self, event: EventRecord)", "description": "Detects whether a given event record corresponds to a shadow API endpoint, returning a ShadowDetectionResult object with relevant details.", "scope": "ShadowAPIDetector", "scopeKind": "class"}, {"name": "None __init__(self, known_keys: Set[str])", "scope": "ShadowAPIDetector", "scopeKind": "class", "description": "unavailable"}], "calls": ["OWASP_RULES.get"], "search-terms": ["ShadowAPIDetector", "detect", "shadow", "heuristic", "API", "known_keys", "EventRecord"], "state": 2, "file_id": 9, "knowledge_revision": 22, "git_revision": "", "ctags": [{"_type": "tag", "name": "ShadowAPIDetector", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^class ShadowAPIDetector:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ShadowDetectionResult", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^class ShadowDetectionResult:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    def __init__(self, known_keys: Set[str]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, known_keys: Set[str])", "scope": "ShadowAPIDetector", "scopeKind": "class"}, {"_type": "tag", "name": "detect", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    def detect(self, event: EventRecord) -> ShadowDetectionResult:$/", "language": "Python", "typeref": "typename:ShadowDetectionResult", "kind": "member", "signature": "(self, event: EventRecord)", "scope": "ShadowAPIDetector", "scopeKind": "class"}, {"_type": "tag", "name": "rule_id", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    rule_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ShadowDetectionResult", "scopeKind": "class"}, {"_type": "tag", "name": "suggested_description", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    suggested_description: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ShadowDetectionResult", "scopeKind": "class"}, {"_type": "tag", "name": "suggested_severity", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    suggested_severity: FindingSeverity = FindingSeverity.MEDIUM$/", "language": "Python", "typeref": "typename:FindingSeverity", "kind": "variable", "scope": "ShadowDetectionResult", "scopeKind": "class"}, {"_type": "tag", "name": "suggested_title", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/shadow_detector.py", "pattern": "/^    suggested_title: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ShadowDetectionResult", "scopeKind": "class"}], "hash": "ead89f9fa452cb16f112d2c08e7a5aae", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/shadow_detector.py", "fields": [{"name": "Optional[str] rule_id", "scope": "ShadowDetectionResult", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] suggested_description", "scope": "ShadowDetectionResult", "scopeKind": "class", "description": "unavailable"}, {"name": "FindingSeverity suggested_severity", "scope": "ShadowDetectionResult", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] suggested_title", "scope": "ShadowDetectionResult", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"22": ""}]}