{"is_source_file": true, "format": "Python", "description": "This source file provides static threat intelligence enrichment functions, including IP reputation analysis, User-Agent heuristics, and suspicious parameter detection for incoming requests. It defines data structures, pattern matching, and a main enrichment function to assess threat signals without external dependencies.", "external_files": [], "external_methods": [], "published": ["enrich_threat_context"], "classes": [{"name": "ThreatEnrichment", "description": "Data class representing the result of threat enrichment, including risk score, indicators, tags, and detailed attributes."}], "methods": [{"name": "ThreatEnrichment enrich_threat_context(ip: Optional[str], path: str, request_headers: Dict[str, str], attributes: Dict[str, str])", "description": "Main function to perform static threat enrichment on incoming request data, combining IP reputation, User-Agent heuristics, and suspicious pattern detection.", "scope": "", "scopeKind": ""}, {"name": "ThreatEnrichment _ip_reputation(ip: Optional[str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "None _score_add(enr: ThreatEnrichment, score: int, indicator: str, tag: str, detail_key: Optional[str] = None, detail_val: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ThreatEnrichment _suspicious_params(path: str, headers: Dict[str, str], attributes: Dict[str, str])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ThreatEnrichment _ua_heuristics(headers: Dict[str, str])", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["_ip_reputation", "_ua_heuristics", "_suspicious_params"], "search-terms": ["ThreatEnrichment", "enrich_threat_context", "static threat heuristics", "IP reputation analysis", "User-Agent heuristics", "suspicious parameter detection"], "state": 2, "file_id": 14, "knowledge_revision": 36, "git_revision": "", "ctags": [{"_type": "tag", "name": "ThreatEnrichment", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^class ThreatEnrichment:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_BAD_NETS", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_BAD_NETS = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_BAD_NETWORKS", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_BAD_NETWORKS = [ipaddress.ip_network(n) for n in _BAD_NETS]$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_HEUR_BAD_UA", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_HEUR_BAD_UA = re.compile(r\"(?i)\\\\b(curl|wget|python-requests|httpclient|aiohttp|libwww|okhttp|n/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_JS_INJECTION", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_JS_INJECTION = re.compile(r\"(?i)<script|onerror=|onload=|javascript:\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_PATH_TRAVERSAL", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_PATH_TRAVERSAL = re.compile(r\"(\\\\.\\\\.\\/|\\\\.\\\\.\\\\\\\\)\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_SQLI_PATTERN", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_SQLI_PATTERN = re.compile(r\"(?i)(\\\\bUNION\\\\b|\\\\bSELECT\\\\b|\\\\bDROP\\\\b|\\\\bINSERT\\\\b|\\\\bUPDATE\\\\b|/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_SSRF_HINT", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_SSRF_HINT = re.compile(r\"(?i)(metadata\\\\.google|latest\\/meta-data|169\\\\.254\\\\.169\\\\.254)\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_URL_PATTERN", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^_URL_PATTERN = re.compile(r\"https?:\\/\\/\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_ip_reputation", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^def _ip_reputation(ip: Optional[str]) -> ThreatEnrichment:$/", "language": "Python", "typeref": "typename:ThreatEnrichment", "kind": "function", "signature": "(ip: Optional[str])"}, {"_type": "tag", "name": "_score_add", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^def _score_add(enr: ThreatEnrichment, score: int, indicator: str, tag: str, detail_key: Optional/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(enr: ThreatEnrichment, score: int, indicator: str, tag: str, detail_key: Optional[str] = None, detail_val: Optional[str] = None)"}, {"_type": "tag", "name": "_suspicious_params", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^def _suspicious_params(path: str, headers: Dict[str, str], attributes: Dict[str, str]) -> Threat/", "language": "Python", "typeref": "typename:ThreatEnrichment", "kind": "function", "signature": "(path: str, headers: Dict[str, str], attributes: Dict[str, str])"}, {"_type": "tag", "name": "_ua_heuristics", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^def _ua_heuristics(headers: Dict[str, str]) -> ThreatEnrichment:$/", "language": "Python", "typeref": "typename:ThreatEnrichment", "kind": "function", "signature": "(headers: Dict[str, str])"}, {"_type": "tag", "name": "details", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^    details: Dict[str, str] = field(default_factory=dict)$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "ThreatEnrichment", "scopeKind": "class"}, {"_type": "tag", "name": "enrich_threat_context", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^def enrich_threat_context(ip: Optional[str], path: str, request_headers: Dict[str, str], attribu/", "language": "Python", "typeref": "typename:ThreatEnrichment", "kind": "function", "signature": "(ip: Optional[str], path: str, request_headers: Dict[str, str], attributes: Dict[str, str])"}, {"_type": "tag", "name": "indicators", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^    indicators: List[str] = field(default_factory=list)$/", "language": "Python", "typeref": "typename:List[str]", "kind": "variable", "scope": "ThreatEnrichment", "scopeKind": "class"}, {"_type": "tag", "name": "risk_score", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^    risk_score: int = 0$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "ThreatEnrichment", "scopeKind": "class"}, {"_type": "tag", "name": "tags", "path": "/home/kavia/workspace/code-generation/api-security-guard-162686-162696/backend/src/api/threat_intel.py", "pattern": "/^    tags: Set[str] = field(default_factory=set)$/", "language": "Python", "typeref": "typename:Set[str]", "kind": "variable", "scope": "ThreatEnrichment", "scopeKind": "class"}], "hash": "a98a1bd1352fb9e7afb78d55c8fe059d", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/threat_intel.py", "fields": [{"name": "_BAD_NETS = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_BAD_NETWORKS = [ipaddress.ip_network(n) for n in _BAD_NETS]", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_HEUR_BAD_UA = re.compile(r\"(?i)\\\\b(curl|wget|python-requests|httpclient|aiohttp|libwww|okhttp|n/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_JS_INJECTION = re.compile(r\"(?i)<script|onerror=|onload=|javascript:\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_PATH_TRAVERSAL = re.compile(r\"(\\\\.\\\\.\\/|\\\\.\\\\.\\\\\\\\)\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_SQLI_PATTERN = re.compile(r\"(?i)(\\\\bUNION\\\\b|\\\\bSELECT\\\\b|\\\\bDROP\\\\b|\\\\bINSERT\\\\b|\\\\bUPDATE\\\\b|/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_SSRF_HINT = re.compile(r\"(?i)(metadata\\\\.google|latest\\/meta-data|169\\\\.254\\\\.169\\\\.254)\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_URL_PATTERN = re.compile(r\"https?:\\/\\/\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, str] details", "scope": "ThreatEnrichment", "scopeKind": "class", "description": "unavailable"}, {"name": "List[str] indicators", "scope": "ThreatEnrichment", "scopeKind": "class", "description": "unavailable"}, {"name": "int risk_score", "scope": "ThreatEnrichment", "scopeKind": "class", "description": "unavailable"}, {"name": "Set[str] tags", "scope": "ThreatEnrichment", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"36": ""}]}